# df_abr = read.csv('portf_abr_1_monthly_2021.csv')
# df_ivff = read.csv('data/update_addition/portf_ivff_1_monthly_2021.csv')
df_sue = read.csv('data/portf_sue_1_monthly_2021.csv')
# df_abr = read.csv('portf_abr_1_monthly_2021.csv')
# df_ivff = read.csv('data/update_addition/portf_ivff_1_monthly_2021.csv')
df_sue = read.csv('data/portf_sue_1_monthly_2021.csv')
gwtwd()
getwd()
# df_abr = read.csv('portf_abr_1_monthly_2021.csv')
# df_ivff = read.csv('data/update_addition/portf_ivff_1_monthly_2021.csv')
df_sue = read.csv('data/portf_sue_1_monthly_2021.csv')
# df_abr = read.csv('portf_abr_1_monthly_2021.csv')
# df_ivff = read.csv('data/update_addition/portf_ivff_1_monthly_2021.csv')
df_sue = read.csv('data/portf_sue_1_monthly_2022.csv')
# df_abr = read.csv('portf_abr_1_monthly_2021.csv')
# df_ivff = read.csv('data/update_addition/portf_ivff_1_monthly_2021.csv')
df_sue = read.csv('data/portf_sue_1_monthly_2022.csv')
# df_abr = read.csv('portf_abr_1_monthly_2021.csv')
# df_ivff = read.csv('data/update_addition/portf_ivff_1_monthly_2021.csv')
df_sue = read.csv('data/portf_sue_1_dailyly_2022.csv')
# df_abr = read.csv('portf_abr_1_monthly_2021.csv')
# df_ivff = read.csv('data/update_addition/portf_ivff_1_monthly_2021.csv')
df_sue = read.csv('data/portf_sue_1_daily_2022.csv')
factor.calc <- function(df){
monthlist = c()
valuelist = c()
for (i in 1:(dim(df)[1]/10)){
temp_df = df[((i-1)*10+1):(i*10),]
ym = paste0(unique(temp_df$year), '-', unique(temp_df$month))
monthlist = append(monthlist, ym)
valuelist = append(valuelist, (temp_df$ret_vw[10] - temp_df$ret_vw[1])/100)
}
output = cbind(monthlist, valuelist)
colnames(output) = c('month','factor')
return(output)
}
# abr = data.frame(factor.calc(df_abr))
# ivff = data.frame(factor.calc(df_ivff))
sue = data.frame(factor.calc(df_sue))
View(sue)
factor.calc <- function(df){
monthlist = c()
valuelist = c()
for (i in 1:(dim(df)[1]/10)){
temp_df = df[((i-1)*10+1):(i*10),]
# ym = paste0(unique(temp_df$year), '-', unique(temp_df$month))
monthlist = unique(temp_df$DATE)
valuelist = append(valuelist, (temp_df$ret_vw[10] - temp_df$ret_vw[1])/100)
}
output = cbind(monthlist, valuelist)
colnames(output) = c('date','factor')
return(output)
}
# abr = data.frame(factor.calc(df_abr))
# ivff = data.frame(factor.calc(df_ivff))
sue = data.frame(factor.calc(df_sue))
View(sue)
df = df_sue
i = 1
temp_df = df[((i-1)*10+1):(i*10),]
View(temp_df)
# ym = paste0(unique(temp_df$year), '-', unique(temp_df$month))
monthlist = unique(temp_df$DATE)
monthlist
factor.calc <- function(df){
monthlist = c()
valuelist = c()
for (i in 1:(dim(df)[1]/10)){
temp_df = df[((i-1)*10+1):(i*10),]
ym = unique(temp_df$DATE)
monthlist = append(monthlist, ym)
valuelist = append(valuelist, (temp_df$ret_vw[10] - temp_df$ret_vw[1])/100)
}
output = cbind(monthlist, valuelist)
colnames(output) = c('date','factor')
return(output)
}
# abr = data.frame(factor.calc(df_abr))
# ivff = data.frame(factor.calc(df_ivff))
sue = data.frame(factor.calc(df_sue))
View(df_sue)
df_ilr = read.csv('data/portf_ilr_12_monthly_2021.csv')
factor.calc <- function(df){
monthlist = c()
valuelist = c()
for (i in 1:(dim(df)[1]/10)){
temp_df = df[((i-1)*10+1):(i*10),]
ym = paste0(unique(temp_df$year), '-', unique(temp_df$month))
monthlist = append(monthlist, ym)
valuelist = append(valuelist, (temp_df$ret_vw[10] - temp_df$ret_vw[1])/100)
}
output = cbind(monthlist, valuelist)
colnames(output) = c('month','factor')
return(output)
}
df_ilr = read.csv('data/portf_ilr_12_monthly_2021.csv')
factor.calc <- function(df){
monthlist = c()
valuelist = c()
for (i in 1:(dim(df)[1]/10)){
temp_df = df[((i-1)*10+1):(i*10),]
ym = paste0(unique(temp_df$year), '-', unique(temp_df$month))
monthlist = append(monthlist, ym)
valuelist = append(valuelist, (temp_df$ret_vw[10] - temp_df$ret_vw[1])/100)
}
output = cbind(monthlist, valuelist)
colnames(output) = c('month','factor')
return(output)
}
ilr = data.frame(factor.calc(df_ilr))
ilr = data.frame(factor.calc(df_ilr))
write.csv(ilr, 'result/ilr.csv')
df_ilr = read.csv('data/portf_ilr_12_monthly_2021.csv')
df = df_ilr
monthlist = c()
valuelist = c()
i = 1
temp_df = df[((i-1)*10+1):(i*10),]
View(temp_df)
ym = paste0(unique(temp_df$year), '-', unique(temp_df$month))
monthlist = append(monthlist, ym)
monthlist
ym
temp_df
dim(df_ilr)
df0 = df_ilr
names1 = colnames(df0)[3]
names1
colnames(df0)
names1 = gsub('_', '', names1)
names1 = sub(pattern = 'rank', replacement = '', names1)
names1
df0 = data.frame(df0)
df_name = unique(df0[,c(1,2)])
df_name = as.matrix(df_name)
df_name
max(df0[,3])
rank = max(df0[,3])
df = as.matrix(df0[,5])/100
df = t(matrix(df,rank,nrow(df)/rank))
df_month0 = df[,rank] -  df[,1]
df_month = cbind(df_name,as.matrix(df_month0))
df_month = as.matrix(df_month)
colnames(df_month) = c('year', 'month', names1)
View(df_month)
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df0 = df_ilr
df0 = data.frame(df0)
df_name = unique(df0[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df0[,3])
df = as.matrix(df0[,5])/100
df = t(matrix(df,rank,nrow(df)/rank))
df_month0 = df[,rank] -  df[,1]
df_month = cbind(df_name,as.matrix(df_month0))
df_month = as.matrix(df_month)
colnames(df_month) = c('year', 'month', names1)
data1 = merge(data1,df_month,by = c('year', 'month'), all =TRUE)
View(df_month)
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df_name = unique(df0[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df0[,3])
rank = max(df_ilr[,3])
df = as.matrix(df_ilr[,5])/100
df = t(matrix(df,rank,nrow(df)/rank))
df_month0 = df[,rank] -  df[,1]
df_month = cbind(df_name,as.matrix(df_month0))
df_month = as.matrix(df_month)
colnames(df_month) = c('year', 'month', names1)
View(df_month)
df_name = unique(df0[,c(1,2)])
df_name = as.matrix(df_name)
colnames(df_month) = c('year', 'month', 'ILR')
View(df_month)
max(df_ilr[,3])
View(df)
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df_eprd = read.csv('data/portf_eprd_1_monthly_2021.csv')
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df_eprd = read.csv('data/portf_eprd_1_monthly_2021.csv')
df_eprd = read.csv('data/portf_eprd_monthly_2021.csv')
factor.calc <- function(df){
df_name = unique(df[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df[,3])
df1 = as.matrix(df[,5])/100
df1 = t(matrix(df1,rank,nrow(df1)/rank))
df2 = df1[,rank] -  df1[,1]
df_month = cbind(df_name,as.matrix(df2))
df_month = as.matrix(df_month)
colnames(df_month) = c('year', 'month', 'ILR')
return(output)
}
ilr = data.frame(factor.calc(df_ilr))
factor.calc <- function(df){
df_name = unique(df[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df[,3])
df1 = as.matrix(df[,5])/100
df1 = t(matrix(df1,rank,nrow(df1)/rank))
df2 = df1[,rank] -  df1[,1]
df_month = cbind(df_name,as.matrix(df2))
df_month = as.matrix(df_month)
colnames(df_month) = c('year', 'month', 'ILR')
return(df_month)
}
ilr = data.frame(factor.calc(df_ilr))
write.csv(ilr, 'result/ilr.csv')
eprd = data.frame(factor.calc(df_eprd))
write.csv(eprd, 'result/eprd.csv')
df_name
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df_eprd = read.csv('data/portf_eprd_monthly_2021.csv')
factor.calc <- function(df){
df_name = unique(df[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df[,3])
df1 = as.matrix(df[,5])/100
df1 = t(matrix(df1,rank,nrow(df1)/rank))
df2 = df1[,rank] -  df1[,1]
df_month = cbind(df_name,as.matrix(df2))
df_month = as.matrix(df_month)
colnames(df_month) = c('year', 'month', 'return')
return(df_month)
}
ilr = data.frame(factor.calc(df_ilr))
write.csv(ilr, 'result/ilr.csv')
eprd = data.frame(factor.calc(df_eprd))
write.csv(eprd, 'result/eprd.csv')
# factor.calc <- function(df){
#   monthlist = c()
#   valuelist = c()
#   for (i in 1:(dim(df)[1]/10)){
#     temp_df = df[((i-1)*10+1):(i*10),]
#     ym = paste0(unique(temp_df$year), '-', unique(temp_df$month))
#     monthlist = append(monthlist, ym)
#     valuelist = append(valuelist, (temp_df$ret_vw[10] - temp_df$ret_vw[1])/100)
#   }
#   output = cbind(monthlist, valuelist)
#   colnames(output) = c('month','factor')
#   return(output)
# }
ilr = data.frame(factor.calc(df_ilr))
write.csv(ilr, 'result/ilr.csv')
mean(df_month)
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df_eprd = read.csv('data/portf_eprd_monthly_2021.csv')
df = df_ilr
df_name = unique(df[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df[,3])
df1 = as.matrix(df[,5])/100
df1 = t(matrix(df1,rank,nrow(df1)/rank))
df2 = df1[,rank] -  df1[,1]
df_month = cbind(df_name,as.matrix(df2))
df_month = as.matrix(df_month)
mean(df_month[,3])
df_eprd = read.csv('data/portf_eprd_monthly_2021.csv')
df = df_eprd
df_name = unique(df[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df[,3])
df1 = as.matrix(df[,5])/100
df1 = t(matrix(df1,rank,nrow(df1)/rank))
df2 = df1[,rank] -  df1[,1]
df_month = cbind(df_name,as.matrix(df2))
df_month = as.matrix(df_month)
mean(df_month[,3])
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df_eprd = read.csv('data/portf_eprd_monthly_2021.csv')
factor.calc <- function(df){
df_name = unique(df[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df[,3])
df1 = as.matrix(df[,5])/100
df1 = t(matrix(df1,rank,nrow(df1)/rank))
df2 = df1[,rank] -  df1[,1]
df_month = cbind(df_name,as.matrix(df2))
df_month = as.matrix(df_month)
if (mean(df_month[,3]) < 0) {
df_month = -1*df_month
}
colnames(df_month) = c('year', 'month', 'return')
return(df_month)
}
ilr = data.frame(factor.calc(df_ilr))
write.csv(ilr, 'result/ilr.csv')
eprd = data.frame(factor.calc(df_eprd))
write.csv(eprd, 'result/eprd.csv')
df_ilr = read.csv('data/portf_ilr_1_monthly_2021.csv')
df_eprd = read.csv('data/portf_eprd_monthly_2021.csv')
factor.calc <- function(df){
df_name = unique(df[,c(1,2)])
df_name = as.matrix(df_name)
rank = max(df[,3])
df1 = as.matrix(df[,5])/100
df1 = t(matrix(df1,rank,nrow(df1)/rank))
df2 = df1[,rank] -  df1[,1]
df_month = cbind(df_name,as.matrix(df2))
df_month = as.matrix(df_month)
if (mean(df_month[,3]) < 0) {
df_month[,3] = -1*df_month[,3]
}
colnames(df_month) = c('year', 'month', 'return')
return(df_month)
}
ilr = data.frame(factor.calc(df_ilr))
write.csv(ilr, 'result/ilr.csv')
eprd = data.frame(factor.calc(df_eprd))
write.csv(eprd, 'result/eprd.csv')
folder_name = "Figure3"
if (!dir.exists(folder_name)) {
dir.create(folder_name)
}
source('../fun_Section.R')
